/**
 * Function: fetchDataFromAPI
 * Description: Fetches data from an API and inserts it into a Google Sheet.
 * Parameters:
 *   - token: Authorization token for API access.
 *   - clientId: Client ID for API access.
 *   - sheetName: Name of the Google Sheet to insert the data.
 */
function fetchDataFromAPI(token, clientId, sheetName) {
    // Add URL of API Endpoint here
    var url = 'Add URL of API Endpoint here';

    var options = {
        'method': 'GET',
        'muteHttpExceptions': false,
        'headers': {
            'Connection': 'keep-alive',
            'Authorization': token,
            'x-myobapi-key': clientId,
            'x-myobapi-version': 'v2',
        }
    };

    var response = UrlFetchApp.fetch(url, options);
    var responseCode = response.getResponseCode();

    if (responseCode === 200) {
        var responseData = JSON.parse(response.getContentText());
        var parsedData = parse_JSON_Data_to_GoogleSheets(responseData, null, null);

        if (parsedData.length > 0) {
            var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
            var range = sheet.getRange(1, 1, parsedData.length, parsedData[0].length);
            range.setValues(parsedData);
        } else {
            console.log("Parsed data is empty. No data inserted into the sheet.");
        }
    } else {
        console.log("Failed to fetch data from the API. Response code: " + responseCode);
    }
}
